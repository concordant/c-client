// Thread that will listen for server notifications
class ServiceHandler: Thread {

  fun run() {
    this.run(work)
  }

  fun work() {
    while (true) {
      v, oid = readMessage()
      if (Global.Handlers.contains(oid)) {
        // call the corresponding handler
        Handlers.get(oid)(v, oid)
      }
    }
  }

  fun stop() {
    exit(this)
  }
}
